<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--<script type="module" src="src/bodypix-video.js"></script>-->
    <!--<script type="module" src="src/facelandmark-video.js"></script>-->
    <!--<script type="module" src="src/handpose-video.js"></script>
    <script type="module" src="src/poseplayer.js"></script>
    <script type="module" src="src/posedetection-video.js"></script>
    <script type="module" src="src/visualization-canvas.js"></script> -->

    <script type="module" src="src/ui/playbackcontrols.js"></script>

    <style>
        #video {
            width: 640px;
            height: 480px;
        }

        #log {
            border-style: solid;
            border-width: 1px;
            width: 500px;
            height: 300px;
            overflow-y: scroll;
            padding: 5px;
        }
    </style>
</head>
<body>
    <pose-playback-controls></pose-playback-controls>
    <button onclick="record()">record</button>
    <button onclick="saveRecording()">save</button>
    <br />
    <!-- <handpose-video id="video" mute loop autoplay camera xsource="./sampleassets/conan.mp4">
        <visualization-canvas dotcolor="#ff0000" dotbackcolor="#000000"></visualization-canvas>
    </handpose-video> -->
    <!-- <pose-player id="video" loop posedata="./sampleassets/posedata.json">
        <visualization-canvas dotcolor="#ff0000" dotbackcolor="#000000"></visualization-canvas>
    </pose-player> -->

    <br />
    <span id="time"></span>
    <input id="scrubber" type="range"
           onmousedown="scrubbing = true"
           onmouseup="scrubbing = false"
           oninput="scrub(event)" min="0" max="100">
    <h3>Events</h3>
    <div id="log"></div>
</body>

<script>
    const video = document.querySelector('#video');
    const log = document.getElementById('log');
    const scrubber = document.getElementById('scrubber');
    let scrubbing = false;
    video.addEventListener('onvideotimeupdate', e => {
        document.getElementById('time').innerText = e.target.currentTime.toFixed(2);
        if (!scrubbing) {
            scrubber.value = e.target.currentPercent;
        }
    });
    video.addEventListener('onvideoplay', e => { log.innerHTML += '<p>Play video</p>'; });
    video.addEventListener('onvideoend', e => { log.innerHTML += '<p>End video</p>'; });
    video.addEventListener('onvideopause', e => { log.innerHTML += '<p>Pause video</p>'; });
    video.addEventListener('onvideoloop', e => { log.innerHTML += '<p>Loop video</p>'; });
    video.addEventListener('onvideosourcechanged', e => { log.innerHTML += `<p>Video source changed: ${e.target.source}</p>`; });
    video.addEventListener('onvideometadata', e => { log.innerHTML += `<p>Video metadata, natural size: ${e.target.naturalSize.width}x${e.target.naturalSize.height}, duration: ${e.target.duration}</p>`; });

    function pause() {
        video.togglePlayback();
    }

    function record() {
        if (video.isRecording) {
            video.stopRecording();
        }
        video.startRecording(true);
    }

    function saveRecording() {
        video.saveRecording();
    }

    function scrub(event) {
        video.currentPercent = Number(event.target.value);
    }
</script>
</html>
